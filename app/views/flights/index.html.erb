<%= form_tag('/flights', method: 'get', class: "form-horizontal" ) do %>
  <div class="form-group row">
    <label for="origin" class="col-sm-2 col-form-label">
      Origin:
    </label>
    <div class="col-sm-10">
      <%= collection_select :flight, :departing_id, Airport.all, :id, :code,{},
      { type: 'text', class: "form-control"} %>
    </div>
  </div>

  <div class="form-group row">
    <label for="destination" class="col-sm-2 col-form-label">
      Destination:
    </label> 
    <div class="col-sm-10">
      <%= collection_select :flight, :arriving_id, Airport.all, :id, :code, {}, { type: 'text', class: "form-control"} %>
    </div>
  </div>

  <div class="form-group row">
    <label for="passengers" class="col-sm-2">
      Passengers:
    </label>
    <div class="col-sm-10">
      <%= select :flight, :passengers, (1..5), {}, { class: "form-control" } %>
    </div>
  </div>

  <div class="form-group row">
    <label for="date" class="col-sm-2">
      Date:
    </label>
    <div class="col-sm-10">
      <%= collection_select :flight, :date, Flight.distinct_dates, :date, :date_formatted, {}, { type: 'date', class: 'form-control' } %>
    <div>
  </div>

  <fieldset <%= "disabled" unless @flights.blank? %> >
    <div class="form-group row">
      <div class='col-sm-12'>
        <%= submit_tag "Find a flight", 
          { type: "submit",
            class: "btn btn-primary btn-block" } %>
      </div>
    </div>
  </fieldset>
<% end %>

<% unless @flights.blank? %>
  <hr></hr>
  <%= form_tag('bookings/new', method: :get) do %>
    <%= hidden_field_tag(:passengers, params[:flight][:passengers]) %>
    <div id="main-flight-info">
      <h3>
        <%= @departing_air.code %> 
        <span class="glyphicon glyphicon-chevron-right"></span> 
        <%= @arriving_air.code %>
      </h3>
      <h4><%= @flights.first.date_formatted %></h4>
    </div>
    <table class="table">
      <thead>
        <tr>
          <th>#</th>
          <th>Departing</th>
          <th>Arriving</th>
          <th>Duration</th> 
        </tr>
      </thead>
      <tbody>
        <div class="form-check-label">
          <%= collection_radio_buttons(:booking, :flight_id, @flights, :id, :date) do |b| %>
            <trow>
              <td><%= b.radio_button %></td>
              <td><%= b.object.time_formatted %></td>
              <td><%= b.object.arriving_formatted %></td>
              <td><%= b.object.duration_formatted %></td>
            </trow>
          <% end %>
        </div>
      </tboby>
    </table>
    <div class="form-group row">
      <div class='col-sm-12'>
        <%= submit_tag "Accept", 
          { type: "submit",
            class: "btn btn-primary btn-block" } %>
      </div>
    </div>
  <% end %>
  <div class="form-group row">
    <div class='col-sm-12'>
      <%= link_to "Clear all", { controller: 'flights', action: 'index' }, 
        class: "btn btn-warning btn-block" %>
    </div>
  </div>
<% end %>